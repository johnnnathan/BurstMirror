
<h2 id="-solution">üìù Solution</h2>

<p>Solution to ‚Äúcrypted string‚Äù by SUSPEKT</p>

<p>Running the app we get an ‚ÄúEnter:‚Äù prompt and entering a random string of character gives us a ‚ÄúFIMOZ OWNER ACCES DENIED!!!!‚Äù, I 
don‚Äôt know what the language is, but I do know that the password was not correct.</p>

<p>Loading up the executable into ghidra and searching for strings does not give us anything of note, I was also not able to get the 
‚ÄúEnter:‚Äù string to show up, meaning that I had to search myself for the main method. Since it is c/c++ it is easy enough to do so, 
by following the call with 3 arguments passed to it.</p>

<p>There is a call to std::cout and one to std::cin, mirroring the behavior that we see when we execute it. Setting a breakpoint at the 
same point in a debugger we can step through the assembly and better understand the flow of the program. If we pay attention to the 
cpu registers we can see that RDX is populated after the ‚Äúlea rdx, qword ptr ss:[rbp-60]‚Äù operation, with the result of the decryption 
function. The string inside the RDX register is ‚ÄúcrackmeYG‚Äù and if we pass that as input to the program the window 
shuts down, meaning that we have found the password.</p>

<p>The encryption algorithm works by initializing posititions at a set offset on the stack with a pair of values. When the second value 
is subtracted from the first one, the ASCII code of the decrypted string‚Äôs xth character is computed. If done for every character in 
the sequence the full decrypted string will have been computed.</p>

<!-- Removed static_files assign -->
<h2 id="-keygen-python">üîë Keygen (Python)</h2>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Solution to "crypted string" by SUSPEKT 
#
# This keygen is just a template for this type of encryption, although the behavior is the same,
# the actual mechanics differ between this implementation and the one seen inside the challenge.
#
# github.com/johnnnathan
</span>

<span class="n">encrypted_values</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0xffffffc4</span> <span class="p">,</span><span class="mh">0xffffff98</span><span class="p">,</span><span class="mh">0xffffffc2</span><span class="p">,</span><span class="mh">0xffffff95</span><span class="p">,</span><span class="mh">0xffffffcc</span><span class="p">,</span><span class="mh">0xffffff99</span><span class="p">,</span><span class="mh">0xffffffc6</span><span class="p">,</span><span class="mh">0xffffff82</span><span class="p">,</span><span class="mh">0xfffffff8</span><span class="p">,</span><span class="mh">0xFFFFFF61</span><span class="p">,</span> <span class="mh">0xFFFFFF26</span><span class="p">,</span> <span class="mh">0xFFFFFF61</span><span class="p">,</span> <span class="mh">0xFFFFFF32</span><span class="p">,</span> <span class="mh">0xFFFFFF61</span><span class="p">,</span><span class="mh">0xFFFFFF2c</span> <span class="p">,</span> <span class="mh">0xFFFFFF61</span><span class="p">,</span> <span class="mh">0xFFFFFF29</span><span class="p">,</span> <span class="mh">0xFFFFFFB1</span><span class="p">]</span>
<span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">encrypted_values</span><span class="p">)</span>
<span class="n">half_length</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">length</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>


<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">half_length</span><span class="p">):</span>
    <span class="n">result</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">encrypted_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">encrypted_values</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">half_length</span><span class="p">])</span>

<span class="n">decrypted_string</span> <span class="o">=</span> <span class="s">''</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">result</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">decrypted_string</span><span class="p">)</span>

</code></pre></div></div>
