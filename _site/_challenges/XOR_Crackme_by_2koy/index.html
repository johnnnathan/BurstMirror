
<h2 id="-solution">üìù Solution</h2>

<p>Solution to ‚ÄúXOR Crackme‚Äù by 2koy</p>

<p>This is a simple C++ crackme that should not take more than half an hour to solve for even the newest Reverse Engineers.</p>

<p>As can be Understood through reading the name, this application uses an XOR operation somewhere in password creation/evaluation.
Loading it up and finding the main method is easy enough. After the entry point find the method call with three parameters, since that 
is the pattern C++ applications follow. There are of course some variable initializations and an output and input method call to 
request the user to input the password and of course accept the password.</p>

<p>In the initialization block we can find a variable that is initialized with a hexadecimal string which will be important later. 
Immediately after the input method call there is another function that uses the password given as a parameter. Delving inside the method
we can find some unimportant steps and at the end an XOR application that is applied on each character in the password. The value the 
characters are XORed with is ox4b which translates to 75 in decimal. We can then see that a value is compared to 0xb(11) and then 
a memcmp call which uses the generated password alongside another value.</p>

<p>The other value is definitely the stored password but turning it into string and giving it as input won‚Äôt work, because of the XOR 
operation. I spent some time thinking about ways to reverse the XOR operations and then realized that the inverse of XOR is XOR itself. 
We need to run the stored password through the XOR operation using the value of 0x4b and then use the result as the password.</p>

<p>The hex representation 0x2f39243c38382a1b393e04 is in little endian so we will have to input the characters in reverse. XORing the 
string per two hex symbols(remember, ASCII has 256 symbols which is one byte or two hex values(16*16 = 256)) gives us ‚ÄúdrowssaPruO‚Äù or 
‚ÄúOurPassword‚Äù in Big-Endian.</p>

<p>Giving it as an input and stepping through the assembly gives us a Access Granted message.</p>

<p>Have a great day :)
github.com/johnnnathan</p>

<!-- Removed static_files assign -->
<h2 id="-keygen-python">üîë Keygen (Python)</h2>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">string</span> <span class="o">=</span> <span class="s">"2f39243c38382a1b393e04"</span> 
<span class="n">key</span> <span class="o">=</span> <span class="mi">75</span>

<span class="n">final_password</span> <span class="o">=</span> <span class="s">""</span>


<span class="k">for</span> <span class="n">ASCII</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">string</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span>
    <span class="c1"># Get the two hex values that form an ASCII symbol
</span>    <span class="n">hex_pair</span> <span class="o">=</span> <span class="n">string</span><span class="p">[</span><span class="n">ASCII</span> <span class="p">:</span> <span class="n">ASCII</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span>

    <span class="c1"># Translate the hex value to decimal notation
</span>    <span class="n">decimal_value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">hex_pair</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>

    <span class="c1"># Perform the XOR operation using the key (0x4b or 0d75)
</span>    <span class="n">result</span> <span class="o">=</span> <span class="n">decimal_value</span> <span class="o">^</span> <span class="n">key</span>

    <span class="c1"># Turn the ASCII code into the ASCII symbol
</span>    <span class="n">character</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="c1"># Append the resulting ASCII symbol to the start of the string to reverse its little-Endianness
</span>    <span class="n">final_password</span> <span class="o">=</span> <span class="n">character</span> <span class="o">+</span> <span class="n">final_password</span>

<span class="c1"># print the Resulting, and stored, password. Should be "OurPassword"
</span><span class="k">print</span><span class="p">(</span><span class="n">final_password</span><span class="p">)</span>

</code></pre></div></div>

