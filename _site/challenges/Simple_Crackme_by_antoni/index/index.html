<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Simple_Crackme_By_Antoni | Crackme Writeups</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Simple_Crackme_By_Antoni" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Reverse engineering challenges &amp; solutions" />
<meta property="og:description" content="Reverse engineering challenges &amp; solutions" />
<link rel="canonical" href="http://localhost:4000/challenges/Simple_Crackme_by_antoni/index/" />
<meta property="og:url" content="http://localhost:4000/challenges/Simple_Crackme_by_antoni/index/" />
<meta property="og:site_name" content="Crackme Writeups" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Simple_Crackme_By_Antoni" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Reverse engineering challenges &amp; solutions","headline":"Simple_Crackme_By_Antoni","url":"http://localhost:4000/challenges/Simple_Crackme_by_antoni/index/"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Crackme Writeups" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Crackme Writeups</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/">Crackmes</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        
<h2 id="-solution">üìù Solution</h2>

<p>This program uses some heavy code obfuscation which results in the main function and strings being difficult to find. Searching for the debug message that is given will land us in the ‚Äúmain‚Äù function. Here input and output is handled as well as the validation of the given key. The program loops over all of the characters of the given key and XORs them with the value 0xaa. The resulting character is compared against the bytes of the stored password and if they are all correct a ‚Äúgood job!‚Äù message is shown.</p>

<p>Have a great day :)
github.com/johnnnathan</p>

<h2 id="-keygen-python">üîë Keygen (Python)</h2>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">get_password</span><span class="p">():</span>
    <span class="n">enc</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0xeb</span><span class="p">,</span> <span class="mh">0xc6</span><span class="p">,</span> <span class="mh">0xcb</span><span class="p">,</span> <span class="mh">0x8a</span><span class="p">,</span> <span class="mh">0xc7</span><span class="p">,</span> <span class="mh">0xcb</span><span class="p">,</span> <span class="mh">0x8a</span><span class="p">,</span> <span class="mh">0xc1</span><span class="p">,</span> <span class="mh">0xc5</span><span class="p">,</span> <span class="mh">0xde</span><span class="p">,</span> <span class="mh">0xcb</span><span class="p">,</span> <span class="mh">0x84</span><span class="p">]</span>
    <span class="n">key</span> <span class="o">=</span> <span class="mh">0xaa</span>
    <span class="n">password</span> <span class="o">=</span> <span class="s">''</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">b</span> <span class="o">^</span> <span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">enc</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">password</span> 

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">pw</span> <span class="o">=</span> <span class="n">get_password</span><span class="p">();</span>
    <span class="c1"># The password needs to be given as an argument surrounded by single quotes, otherwise the program won't read them properly
</span>    <span class="k">print</span><span class="p">(</span><span class="n">pw</span><span class="p">)</span>

</code></pre></div></div>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Crackme Writeups</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Crackme Writeups</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Reverse engineering challenges &amp; solutions</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
